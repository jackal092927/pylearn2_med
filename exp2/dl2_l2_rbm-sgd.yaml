!obj:pylearn2.train.Train
{
    dataset: &train !obj:pylearn2.scripts.med_ml.cin_feature2.CIN_FEATURE2 {
        raw: !obj:pylearn2.datasets.mnist.MNIST
        {
            which_set: 'train',
        },
        transformer: !pkl: "%(save_path)s/dl2_l1_gram-sgd.pkl"
    },

    model: !obj:pylearn2.models.rbm.GaussianBinaryRBM
    {
        nvis : %(nvis)i,
        nhid : %(nhid)i,
        irange: 0.05,
        energy_function_class : !obj:pylearn2.energy_functions.rbm_energy.grbm_type_1 {},
        learn_sigma : True,
        init_sigma : .4,
        init_bias_hid : -2.,
        mean_vis : False,
        sigma_lr_scale : 1e-3

    },


    algorithm: !obj:pylearn2.training_algorithms.sgd.SGD
    {
        learning_rate : 1e-1,
        batch_size : %(batch_size)i,
        monitoring_batches : %(monitoring_batches)i,
        monitoring_dataset : *train,

        cost : !obj:pylearn2.costs.autoencoder.MeanSquaredReconstructionError {},
        termination_criterion : !obj:pylearn2.termination_criteria.MonitorBased
        {
            prop_decrease : 0.01,
            N : 1,
        },
    },
    extensions : [!obj:pylearn2.training_algorithms.sgd.MonitorBasedLRAdjuster {}],
    save_path: "%(save_path)s/dl2_l2_rbm-sgd.pkl",
    save_freq: 1

}
